# ==============================================
# YNM SAFETY - GITLEAKS CONFIGURATION
# Secret scanning rules for CI/CD integration
# ==============================================
# Install: brew install gitleaks
# Usage: gitleaks detect --source . --verbose
# ==============================================

title = "YNM Security - Secret Detection Rules"

[extend]
# Use default gitleaks rules as base
useDefault = true

# Additional custom rules for this project
[[rules]]
id = "google-api-key"
description = "Google API Key"
regex = '''AIza[0-9A-Za-z_-]{35}'''
tags = ["api-key", "google"]

[[rules]]
id = "google-private-key"
description = "Google Service Account Private Key"
regex = '''-----BEGIN (RSA |EC )?PRIVATE KEY-----'''
tags = ["private-key", "google"]

[[rules]]
id = "gmail-app-password"
description = "Gmail App Password (16 char format)"
regex = '''[a-z]{4}\s[a-z]{4}\s[a-z]{4}\s[a-z]{4}'''
tags = ["password", "gmail"]

[[rules]]
id = "generic-password-assignment"
description = "Password assignment in code"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*['\"][^'\"]{4,}['\"]'''
tags = ["password"]

[[rules]]
id = "generic-secret-assignment"
description = "Secret assignment in code"
regex = '''(?i)(secret|api_key|apikey|access_token)\s*[:=]\s*['\"][^'\"]{8,}['\"]'''
tags = ["secret"]

# Files to always ignore (not secrets)
[allowlist]
paths = [
    '''\.env\.example$''',
    '''package-lock\.json$''',
    '''yarn\.lock$''',
    '''pnpm-lock\.yaml$''',
    '''\.gitleaks\.toml$''',
]

# Specific strings to ignore (false positives)
regexes = [
    '''your_[a-z_]+_here''',  # Placeholder values
    '''example\.com''',
    '''placeholder''',
    '''YOUR_.*_KEY''',
    '''x{4}\s+x{4}\s+x{4}\s+x{4}''', # README placeholder "xxxx xxxx xxxx xxxx"
]
