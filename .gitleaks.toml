# ==============================================
# YNM SAFETY - GITLEAKS CONFIGURATION
# Secret scanning rules for CI/CD integration
# ==============================================
# Install: brew install gitleaks
# Usage: gitleaks detect --source . --verbose
# ==============================================

title = "YNM Security - Secret Detection Rules"

[extend]
# Use default gitleaks rules as base
useDefault = true

# Files to always ignore (not secrets - templates and documentation)
[allowlist]
paths = [
    '''\.env\.example$''',
    '''\.env\.gcp\.example$''',
    '''package-lock\.json$''',
    '''yarn\.lock$''',
    '''pnpm-lock\.yaml$''',
    '''\.gitleaks\.toml$''',
    '''README\.md$''',
    '''SETUP\.md$''',
    '''docs/.*\.md$''',
]

# Specific strings to ignore (false positives and placeholders)
regexes = [
    '''your_[a-z_]+_here''',
    '''example\.com''',
    '''placeholder''',
    '''YOUR_.*_KEY''',
    '''x{4}\s+x{4}\s+x{4}\s+x{4}''',
    '''AIzaSyX{28,}''',
    '''6Lc[XY]{33,}''',
    '''REPLACE_ME''',
    '''your-email@gmail\.com''',
    '''your_actual_[a-z_]+_here''',
]

# Commit-level allowlist for historical commits with false positives
commits = [
    # Historical commits with placeholder documentation
]

# Stopwords - common words that trigger false positives
stopwords = [
    "water",
    "paint",
    "kerb",
    "base",
    "road",
    "edge",
    "visi",
    "high",
    "nage",
    "expo",
    "cing",
    "nces",
    "ater",
    "mater",
]
